<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport"content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>6RPlus - 让世界看到你的想象力</title><link data-n-head="ssr" rel="icon" type="image/x-icon" href="./favicon.ico"><style>*{margin:0;padding:0;box-sizing:border-box;font-family:"Microsoft YaHei",Arial,sans-serif;-webkit-tap-highlight-color:transparent}body{background-color:#f4f5f7;display:flex;min-height:100vh;overflow-x:hidden}a{text-decoration:none;color:inherit}.sidebar{width:180px;background-color:#ff6b35;color:white;display:flex;flex-direction:column;position:fixed;height:100%;left:0;top:0;z-index:1001;transition:transform 0.3s ease}.logo{font-size:32px;font-weight:bold;padding:20px 0;text-align:center;border-bottom:1px solid rgba(255,255,255,0.1)}.nav-btn{display:block;padding:15px 20px;color:white;font-size:16px;font-weight:bold;transition:background 0.2s;cursor:pointer}.nav-btn:hover,.nav-btn.active{background-color:rgba(255,255,255,0.2)}.sidebar-footer{margin-top:auto;padding:20px;font-size:12px;text-align:center;line-height:1.8;background:rgba(0,0,0,0.05)}.sidebar-footer a{text-decoration:underline;color:white}.main-content{margin-left:180px;flex:1;width:calc(100%-180px);display:flex;flex-direction:column;transition:margin 0.3s ease,width 0.3s ease}.top-bar{height:50px;background:white;box-shadow:0 1px 3px rgba(0,0,0,0.1);display:flex;justify-content:space-between;align-items:center;padding:0 20px;font-size:14px;color:#333;position:fixed;top:0;left:180px;right:0;z-index:1000;transition:left 0.3s ease}.menu-toggle{display:none;font-size:24px;cursor:pointer;color:#666;margin-right:15px}.user-info{display:flex;align-items:center;gap:10px;margin-left:auto}.avatar{width:30px;height:30px;border-radius:50%;border:1px solid#eee}.container{padding:70px 20px 20px;width:100%;margin-top:0}.game-wrapper{background:#fff;border:1px solid#e1e4e8;border-radius:4px;overflow:hidden}.game-title-bar{background:#fafafa;padding:15px 20px;border-bottom:1px solid#e1e4e8;display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap}.game-id{font-size:14px;color:#ff6b35;font-weight:bold;margin-right:10px}.game-name{font-size:18px;font-weight:bold;color:#333}.stats-bar{background:#fff;padding:10px 20px;font-size:12px;color:#999;display:flex;flex-wrap:wrap;gap:20px;border-bottom:1px solid#eee}.stat-item span{color:#333;font-weight:bold;margin-left:4px}.game-body{padding:20px;position:relative}.cover-img{float:left;max-width:240px;height:auto;border:4px solid#fff;box-shadow:0 1px 4px rgba(0,0,0,0.2);margin-right:20px;margin-bottom:20px;background-color:#f0f0f0}.info-block{overflow:hidden}.tag-list{margin-bottom:10px}.tag{display:inline-block;background:#fff0e6;color:#ff6b35;padding:2px 8px;font-size:12px;border-radius:4px;margin-right:5px;margin-bottom:5px;border:1px solid#ffdec2}.desc{font-size:14px;line-height:1.6;color:#333;margin-top:15px;white-space:pre-wrap}.update-log{margin-top:30px;background:#f9f9f9;padding:15px;border:1px solid#eee;border-radius:4px;clear:both}.log-title{font-weight:bold;margin-bottom:10px;color:#555}.log-entry{font-size:12px;color:#666;border-bottom:1px dashed#ddd;padding:5px 0}.log-entry:last-child{border:none}.expand-comment-btn{display:block;width:100%;background:#f4f5f7;color:#ff6b35;text-align:center;padding:12px;margin-top:20px;cursor:pointer;font-weight:bold;border:1px solid#ddd;border-radius:4px}.expand-comment-btn:hover{background:#ffece6}.comments-container{display:none;margin-top:20px}.comment-item{display:flex;padding:15px 0;border-bottom:1px solid#eee}.c-avatar{width:40px;height:40px;border-radius:50%;margin-right:15px;flex-shrink:0;background-color:#f0f0f0}.c-info{flex:1}.c-user{font-size:13px;font-weight:bold;color:#ff6b35;margin-bottom:4px;cursor:pointer}.c-user:hover{text-decoration:underline}.c-text{font-size:14px;color:#333;line-height:1.5}.c-time{font-size:12px;color:#999;margin-top:5px}.comments-pagination{display:none;margin-top:20px;text-align:center;padding:10px}.page-btn{background:#ff6b35;color:white;border:none;padding:8px 16px;margin:0 5px;border-radius:4px;cursor:pointer;font-size:13px}.page-btn:disabled{background:#ccc;cursor:not-allowed}.page-info{font-size:13px;color:#666;margin:0 10px}@media(max-width:768px){.sidebar{transform:translateX(-100%);width:240px;box-shadow:2px 0 5px rgba(0,0,0,0.2);z-index:1002}.sidebar.active{transform:translateX(0)}.main-content{margin-left:0;width:100%;transition:none}.top-bar{left:0!important;right:0!important;z-index:1001;padding:0 20px;transition:none}.menu-toggle{display:flex}.container{padding:70px 10px 20px;margin-top:0}.cover-img{float:none;width:100%;max-width:100%;margin-right:0;margin-bottom:15px}.stats-bar{gap:10px}.overlay{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.5);z-index:1000}.overlay.active{display:block}}</style></head><body><div class="overlay"onclick="toggleSidebar()"></div><nav class="sidebar"><div class="logo">6R+</div><a href="index"class="nav-btn">首页</a><a href="about"class="nav-btn">关于</a><div class="sidebar-footer"><div style="font-weight:bold; margin-bottom:5px;">66RPG API Helper</div><div>&copy;<span id="year"></span>mtdcmz</div><div style="margin: 8px 0;"><a href="https://space.bilibili.com/426046208"target="_blank">Bili</a>·<a href="https://github.com/mtdcmz"target="_blank">GitHub</a></div><div id="datetime"></div></div></nav><main class="main-content"><header class="top-bar"><div class="menu-toggle"onclick="toggleSidebar()">☰</div><div class="user-info"><span id="greeting"></span>,<img src="https://wcdn1.cgyouxi.com/avatar/women_big.jpg"class="avatar"alt="avatar"><span>游客</span></div></header><div class="container"id="contentArea"><div style="text-align:center; padding:50px; color:#666;">正在查询数据...</div></div></main><script>function toggleSidebar(){const sidebar=document.querySelector('.sidebar');const overlay=document.querySelector('.overlay');sidebar.classList.toggle('active');overlay.classList.toggle('active')}function updateTime(){const now=new Date();document.getElementById('year').textContent=now.getFullYear();const pad=n=>n<10?'0'+n:n;const weekDays=['周日','周一','周二','周三','周四','周五','周六'];const timeStr=`${now.getFullYear()}/${pad(now.getMonth()+1)}/${pad(now.getDate())}${weekDays[now.getDay()]}`;const clockStr=`${pad(now.getHours())}:${pad(now.getMinutes())}:${pad(now.getSeconds())}`;document.getElementById('datetime').innerHTML=`${timeStr}<br>${clockStr}(北京时间)`;const h=now.getHours();let greet="";if(h>=5&&h<11)greet="早上好";else if(h>=11&&h<13)greet="中午好";else if(h>=13&&h<18)greet="下午好";else greet="晚上好";document.getElementById('greeting').textContent=greet}setInterval(updateTime,1000);updateTime();function createPlaceholderSVG(width,height,text="无封面"){const svg=`<svg xmlns="http://www.w3.org/2000/svg"width="${width}"height="${height}"viewBox="0 0 ${width} ${height}"><rect width="100%"height="100%"fill="#f0f0f0"/><rect x="10%"y="10%"width="80%"height="80%"fill="#ddd"stroke="#ccc"stroke-width="1"/><line x1="20%"y1="30%"x2="80%"y2="70%"stroke="#aaa"stroke-width="1"stroke-dasharray="2,2"/><line x1="80%"y1="30%"x2="20%"y2="70%"stroke="#aaa"stroke-width="1"stroke-dasharray="2,2"/><text x="50%"y="50%"text-anchor="middle"dy=".3em"fill="#999"font-size="14"font-family="Arial">${text}</text></svg>`;return`data:image/svg+xml;charset=UTF-8,${encodeURIComponent(svg)}`}const API_BASE='https://66rpg.mtdcmz.dpdns.org/api';const urlParams=new URLSearchParams(window.location.search);const gameId=urlParams.get('id');let currentCommentPage=1;let totalCommentPages=1;async function init(){if(!gameId){document.getElementById('contentArea').innerHTML='<div style="color:red; text-align:center; margin-top:20px;">错误：未提供游戏ID</div>';return}try{const res=await fetch(`${API_BASE}/game/${gameId}?updates=1`);const json=await res.json();if(json.status===1){renderGame(json.data)}else{document.getElementById('contentArea').innerHTML=`<div style="color:red; text-align:center;">查询失败:${json.message||'未知错误'}</div>`}}catch(e){console.error(e);document.getElementById('contentArea').innerHTML='<div style="color:red; text-align:center;">网络请求错误，请检查网络或跨域设置</div>'}}function renderGame(data){if(data.gname&&data.gindex){document.title=`${data.gname} - G${data.gindex} - 6RPlus - 让世界看到你的想象力`}let pubDate="未知日期";if(data.create_time){const ts=parseInt(data.create_time);const timestamp=ts.toString().length===10?ts*1000:ts;const d=new Date(timestamp);if(d.toString()!=='Invalid Date'){pubDate=d.toLocaleDateString().replace(/\//g,'-')}else{if(data.first_pub_time&&data.first_pub_time.toString().length===8){const year=data.first_pub_time.toString().substring(0,4);const month=data.first_pub_time.toString().substring(4,6);const day=data.first_pub_time.toString().substring(6,8);pubDate=`${year}-${month}-${day}`}}}let tagsHtml='';if(data.tags&&Array.isArray(data.tags)){if(data.tags.length>0&&typeof data.tags[0]==='object'&&data.tags[0].tname){tagsHtml=data.tags.map(t=>`<span class="tag">${t.tname}</span>`).join('')}else{tagsHtml=data.tags.map(t=>`<span class="tag">${t}</span>`).join('')}}const logs=(data.update_logs||[]).map(l=>`<div class="log-entry"><span style="color:#999;margin-right:10px;">${l.update_time}</span>${l.content}</div>`).join('')||'<div style="padding:10px; color:#999;">暂无更新日志</div>';const gindex=data.gindex||'未知';const gname=data.gname||'未知游戏';const author_uid=data.author_uid||'';const author_uname=data.author_uname||'未知作者';const play_times=data.play_times||0;const flowers=data.flowers!==undefined?data.flowers:0;const favorites=data.favorites!==undefined?data.favorites:0;const likes=data.likes!==undefined?data.likes:0;const real_thumb=data.real_thumb||'';const description=data.description||'该作者很懒，没有填写简介。';const placeholderUrl=createPlaceholderSVG(240,320,'封面加载中');const html=`<div class="game-wrapper"><div class="game-title-bar"><div><span class="game-id">G${gindex}</span><span class="game-name">${gname}</span></div><div style="font-size:12px; color:#666; margin-top:5px;">作者:<a href="https://www.66rpg.com/friend/${author_uid}"target="_blank"style="color:#ff6b35; font-weight:bold;">${author_uname}</a>(UID:${author_uid})</div></div><div class="stats-bar"><div class="stat-item">游玩次数:<span>${play_times}</span></div><div class="stat-item">鲜花:<span>${flowers}</span></div><div class="stat-item">收藏:<span>${favorites}</span></div><div class="stat-item">点赞:<span>${likes}</span></div><div class="stat-item"style="margin-left:auto;">发布:<span>${pubDate}</span></div></div><div class="game-body"><img src="${real_thumb}"class="cover-img"onerror="this.src='${placeholderUrl}'"><div class="info-block"><div class="tag-list">${tagsHtml}</div><div class="desc">${description}</div></div><div class="update-log"><div class="log-title">最近更新日志</div>${logs}</div><div class="expand-comment-btn"onclick="loadComments(${gindex}, 1, this)">展开评论区</div><div id="commentsContainer"class="comments-container"></div><div id="commentsPagination"class="comments-pagination"></div></div></div>`;document.getElementById('contentArea').innerHTML=html}async function loadComments(gameId,page=1,btn=null){const container=document.getElementById('commentsContainer');const pagination=document.getElementById('commentsPagination');container.style.display='block';container.innerHTML='<div style="text-align:center; padding:20px; color:#999;">正在加载评论...</div>';if(btn)btn.style.display='none';pagination.style.display='none';currentCommentPage=page;try{const res=await fetch(`${API_BASE}/comments/${gameId}?page=${page}&limit=10&sort=2&desc=1`);const json=await res.json();console.log("评论API返回:",json);if(json.status===1&&json.data&&Array.isArray(json.data.comments)){const comments=json.data.comments;totalCommentPages=json.data.total_pages||1;if(comments.length===0){container.innerHTML='<div style="text-align:center; padding:20px; color:#999;">暂无评论</div>';return}let html='';comments.forEach(c=>{const userId=c.user_id||c.uid||'';const userName=c.username||'匿名用户';const userAvatar=c.user_avatar||'https://wcdn1.cgyouxi.com/avatar/women_big.jpg';const commentText=c.comment||'';const addTime=c.add_time_string||'';const likeCount=c.like_count||0;html+=`<div class="comment-item"><img src="${userAvatar}"class="c-avatar"onerror="this.src='${createPlaceholderSVG(40, 40, '头像')}'"><div class="c-info"><div class="c-user"onclick="window.open('https://www.66rpg.com/friend/${userId}', '_blank')">${userName}</div><div class="c-text">${commentText}</div><div class="c-time">${addTime}·赞${likeCount}</div></div></div>`});container.innerHTML=html;renderPagination(gameId)}else{container.innerHTML='<div style="text-align:center; padding:20px; color:#999;">评论加载完成，但没有数据。</div>'}}catch(e){console.error("评论加载出错:",e);container.innerHTML='<div style="text-align:center; padding:20px; color:red;">评论加载失败，请重试。</div>';if(btn)btn.style.display='block'}}function renderPagination(gameId){const pagination=document.getElementById('commentsPagination');if(totalCommentPages<=1){pagination.style.display='none';return}let html=`<button class="page-btn"${currentCommentPage<=1?'disabled':''}onclick="loadComments(${gameId}, ${currentCommentPage - 1})">上一页</button><span class="page-info">第${currentCommentPage}页/共${totalCommentPages}页</span><button class="page-btn"${currentCommentPage>=totalCommentPages?'disabled':''}onclick="loadComments(${gameId}, ${currentCommentPage + 1})">下一页</button>`;pagination.innerHTML=html;pagination.style.display='block'}init();</script></body></html>